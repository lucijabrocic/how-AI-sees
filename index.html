<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8" />
<title>How AI Sees â€” Draw Demo</title>
<style>
  body { font-family: sans-serif; text-align: center; background: #f7f7f7; }
  h1 { font-size: 22px; }
  canvas {
    background: white;
    border: 2px solid black;
    touch-action: none; /* IMPORTANT for mobile drawing */
  }
  .btns button { margin: 6px; padding: 10px 14px; font-size: 15px; }
</style>
</head>
<body>

<h1>ðŸ§  How AI Sees Your Drawing</h1>
<p>Draw a number (0â€“9) with your finger:</p>

<canvas id="draw" width="280" height="280"></canvas>

<div class="btns">
  <button onclick="clearCanvas()">Clear</button>
  <button onclick="pixelate()">Pixelate</button>
  <button onclick="showRGB()">RGB Channels</button>
  <button onclick="predictDigit()">AI Guess</button>
</div>

<h3>Output:</h3>
<div id="output"></div>

<script>
// ---- Drawing ----
const canvas = document.getElementById("draw");
const ctx = canvas.getContext("2d");
ctx.lineWidth = 18;
ctx.lineCap = "round";
ctx.strokeStyle = "black";

let drawing = false;

// helper for coordinates
function getPos(e) {
  const rect = canvas.getBoundingClientRect();
  if (e.touches) {
    return {
      x: e.touches[0].clientX - rect.left,
      y: e.touches[0].clientY - rect.top
    };
  } else {
    return { x: e.offsetX, y: e.offsetY };
  }
}

function startDrawing(e) {
  e.preventDefault();
  drawing = true;
  const pos = getPos(e);
  ctx.beginPath();
  ctx.moveTo(pos.x, pos.y);
}

function stopDrawing(e) {
  e.preventDefault();
  drawing = false;
}

function draw(e) {
  if (!drawing) return;
  e.preventDefault();
  const pos = getPos(e);
  ctx.lineTo(pos.x, pos.y);
  ctx.stroke();
}

// Mouse
canvas.addEventListener("mousedown", startDrawing);
canvas.addEventListener("mouseup", stopDrawing);
canvas.addEventListener("mousemove", draw);

// Touch
canvas.addEventListener("touchstart", startDrawing);
canvas.addEventListener("touchend", stopDrawing);
canvas.addEventListener("touchmove", draw);

// ---- Utilities ----
function clearCanvas() {
  ctx.fillStyle = "white";
  ctx.fillRect(0, 0, canvas.width, canvas.height);
  document.getElementById("output").innerHTML = "";
}
clearCanvas();

// ---- Pixelate ----
function pixelate() {
  let off = document.createElement("canvas");
  off.width = off.height = 28;
  off.getContext("2d").drawImage(canvas, 0, 0, 28, 28);

  let big = document.createElement("canvas");
  big.width = big.height = 280;
  let bctx = big.getContext("2d");
  bctx.imageSmoothingEnabled = false;
  bctx.drawImage(off, 0, 0, 28, 28, 0, 0, 280, 280);

  document.getElementById("output").innerHTML =
    "<p><b>Pixelated (28Ã—28):</b></p>";
  document.getElementById("output").appendChild(big);
}

// ---- RGB channels ----
function showRGB() {
  const img = ctx.getImageData(0, 0, 280, 280);
  const { width, height, data } = img;

  function channelCanvas(filter) {
    let c = document.createElement("canvas");
    c.width = width; c.height = height;
    let cx = c.getContext("2d");
    let d = cx.createImageData(width, height);

    for (let i = 0; i < data.length; i += 4) {
      d.data[i]   = filter === "r" ? data[i]   : 0;
      d.data[i+1] = filter === "g" ? data[i+1] : 0;
      d.data[i+2] = filter === "b" ? data[i+2] : 0;
      d.data[i+3] = 255;
    }
    cx.putImageData(d, 0, 0);
    return c;
  }

  document.getElementById("output").innerHTML =
    "<p><b>RGB Channels:</b></p>";

  ["r","g","b"].forEach(ch =>
    document.getElementById("output").appendChild(channelCanvas(ch))
  );
}

// ---- Fake AI digit prediction ----
function predictDigit() {
  let mini = document.createElement("canvas");
  mini.width = mini.height = 28;
  mini.getContext("2d").drawImage(canvas, 0, 0, 28, 28);

  let img = mini.getContext("2d").getImageData(0, 0, 28, 28);
  let data = img.data;

  let sumX = 0, sumY = 0, count = 0;
  for (let y = 0; y < 28; y++) {
    for (let x = 0; x < 28; x++) {
      let i = (y * 28 + x) * 4;
      let v = 255 - data[i];
      if (v > 40) {
        sumX += x;
        sumY += y;
        count++;
      }
    }
  }

  let cx = sumX / count;
  let cy = sumY / count;

  let guess = "?";
  if (count < 40) guess = "1";
  else if (cy < 10) guess = "7";
  else if (cx < 10) guess = "0";
  else if (cx > 18) guess = "3";
  else guess = "8";

  document.getElementById("output").innerHTML =
    `<h2>ðŸ¤– AI thinks this is: <b>${guess}</b></h2>`;
}
</script>

</body>
</html>
